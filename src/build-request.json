{
  "kind": "build_request",
  "title": "Test Update & Recalculate Risk button and remove Test Email Configuration button",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-99",
      "text": "Remove the 'Test Email Configuration' button from the GovernmentDataPanel component (frontend/src/components/GovernmentDataPanel.tsx), including the button UI element, click handler function, and all associated test email logic",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "REMOVE THE TEST EMAIL BUTOON PLS"
        ]
      },
      "acceptanceCriteria": [
        "The 'Test Email Configuration' button is no longer visible in the Government Data Update Panel",
        "All test email functionality code is removed from GovernmentDataPanel.tsx",
        "The component renders correctly without the test button"
      ]
    },
    {
      "id": "REQ-100",
      "text": "Verify and test the 'Update & Recalculate Risk' button functionality in the GovernmentDataPanel component to ensure it: (1) validates all 15 input fields (Ward, Rainfall, 7-day avg rainfall, Humidity, 7-day avg humidity, Turbidity, Bacteria Index, Sanitation Coverage, Water Treatment Coverage, Population Density, Reported Cases, Water Source Type, Chlorination Status, PHC Capacity, Emergency Response Status), (2) calls the backend predictOutbreakRisk function with the environmental data, (3) successfully updates all dashboard visualizations (RiskGauge, DiseaseClassification, WardHeatmap, InterventionPriority), (4) creates a new entry in AlertHistory with all input data plus calculated risk outputs, (5) triggers automatic email alerts when risk exceeds 70%, (6) shows proper loading states during calculation, (7) displays success confirmation or validation error messages",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "CHECK THE UPDATE AND RECALCULATE RISK PLS"
        ]
      },
      "acceptanceCriteria": [
        "All 15 input fields are properly validated before submission",
        "Backend predictOutbreakRisk is called with correct environmental parameters",
        "RiskGauge component updates with the new risk percentage and color-coded level",
        "DiseaseClassification component updates with recalculated disease probabilities",
        "WardHeatmap updates showing the affected ward with new risk level and color",
        "InterventionPriority component recalculates priority scores with updated ward data",
        "A complete alert record is stored in localStorage under 'cholera_alerts' key with all environmental inputs, calculated outputs, email status, and timestamp",
        "Automatic email alert is triggered via EmailAlertService when risk percentage > 70%",
        "Loading spinner appears during backend calculation and disappears on completion",
        "Success toast notification displays 'Risk calculation completed successfully' or similar message",
        "Validation errors are shown for invalid or missing field values",
        "Error messages are displayed if backend call fails with specific error details"
      ]
    }
  ],
  "constraints": [
    "Maintain existing EmailJS configuration with service_hf3e6oq, template_3dldpfg, KHu3JNagtUgZCsDcG",
    "Preserve all existing alert storage logic in localStorage under 'cholera_alerts' key",
    "Do not modify the backend predictOutbreakRisk function signature or core calculation logic",
    "Keep all existing dashboard visualizations and their update mechanisms intact"
  ],
  "nonGoals": [
    "Adding new input fields to the Government Data Update Panel",
    "Changing the risk calculation formula in the backend",
    "Modifying EmailJS credentials or template structure",
    "Adding new visualization components to the dashboard"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}